---
import type { Product } from '@/types';

interface Props {
  product: Product;
}

const { product } = Astro.props;
const price = parseFloat(product.price);
---

<a href={`/products/${product.id}`} class="group block">
  <div class="h-full rounded-xl border border-divider bg-content1 shadow-sm transition-transform hover:scale-[1.02] overflow-hidden">
    <div class="overflow-hidden">
      <img
        src={product.imageUrl || 'https://via.placeholder.com/400x300'}
        alt={product.name}
        class="w-full h-48 object-cover transition-transform group-hover:scale-105"
        loading="lazy"
      />
    </div>
    <div class="flex flex-col items-start gap-1 px-4 py-4">
      {product.category && (
        <span class="text-xs text-default-400 uppercase tracking-wide">
          {product.category.name}
        </span>
      )}
      <h3 class="font-semibold text-foreground line-clamp-1">{product.name}</h3>
      <p class="text-sm text-default-500 line-clamp-2">{product.description}</p>
      <div class="flex items-center justify-between w-full mt-2">
        <span class="text-lg font-bold text-primary">${price.toFixed(2)}</span>
        {product.stock <= 0 && (
          <span class="text-xs text-danger font-medium">Out of stock</span>
        )}
        {product.stock > 0 && product.stock <= 5 && (
          <span class="text-xs text-warning font-medium">Only {product.stock} left</span>
        )}
      </div>
    </div>
  </div>
</a>
